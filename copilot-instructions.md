# プロジェクトコーディングガイドライン：クリーンで読みやすいC#コードのために

このドキュメントは、プロジェクトにおけるC#コードの品質向上と、開発プロセスの標準化のためのガイドラインを定めます。GitHub Copilotを含む開発ツールは、以下の原則に従ってコード生成・修正を行うよう努めてください。**このガイドラインは、常に参照されるべき主要な指針です。**

---

### 1. 名前付けの原則

* **明確で具体的な名前:** 変数、関数、クラス、メソッドの名前は、その目的、役割、意図を明確に表すものとします。略語は極力避け、一般的なもの以外は使用しません。
    * **例:** `data`より`customerData`、`calc`より`CalculateTotalAmount`。
* **適切な抽象度:** 名前の抽象度は、それが表す概念の抽象度と一致させます。
* **一貫性:** 同一プロジェクト内では、類似の概念には一貫した命名規則を使用します。C#の標準的な命名規則（PascalCase, camelCaseなど）に従ってください。

---

### 2. コメントの原則

* **なぜ？を説明するコメント:** コードの「何を（What）」ではなく、「なぜ（Why）」そう記述されているのか、その背景や意図、トレードオフを説明します。
* **TODOコメントの活用:** 未実装、一時的な解決策、将来的な改善点には`TODO:`タグを付けて記述します。
* **冗長なコメントの回避:** コードを見ればわかることはコメントしません。コード自体を自己説明的にする努力を優先します。
* **設計上の決定と理由:** 複雑なロジックや特定の設計上の選択には、その決定に至った理由を簡潔に記述します。

---

### 3. C#コードの構造と表現

* **処理の分割と単一責任:** 関数やメソッドは小さく保ち、一つのことだけを実行する（単一責任の原則）ようにします。
* **早期リターン/早期終了:** エラー条件や特殊なケースは、関数の早い段階で処理し、メインのロジックが深くネストするのを避けます。
* **LINQの活用（シンプルに）:** データ操作にはLINQを積極的に活用しますが、**開発歴1〜2年のエンジニアでも理解しやすいよう、複雑なネストや難解な記述は避けてください。** `Select`, `Where`, `OrderBy`, `ToList`など、基本的な操作を中心に使います。
    * **良い例:** `customers.Where(c => c.IsActive).ToList();`
    * **避ける例:** 過度にチェーンされた複雑なLINQクエリや、理解しにくい匿名型、Tupleの多用。
* **ブール値の明確な表現:** ブール値を返す関数や変数には、`Is`、`Has`、`Can`などの接頭辞を使用します。
* **プロパティの利用:** 公開フィールドではなく、プロパティを使用します。
* **Null条件演算子とNull合体演算子:** 適切に利用して、Null参照例外を安全に扱います。

---

### 4. 可読性を高めるその他の方針

* **依存関係の明確化:** 関数やクラスの依存関係は、明示的に示されるべきです。特にDI（Dependency Injection）を使用する場合は、そのパターンに従います。
* **魔法の数字/文字列の排除:** リテラル値ではなく、定数やEnumを使用します。
* **エラーハンドリング:** エラーは適切に捕捉し、ユーザーやシステムにとって理解しやすいメッセージを提供します。ログ出力は適切に行います。
* **DRY (Don't Repeat Yourself) 原則:** コードの重複を避けます。共通のロジックは関数やクラスとして抽出し再利用します。
* **テスト容易性:** コードはテストしやすいように設計します。単体テストが書きやすいように、依存性を減らしたコードを心がけます。
* **既存コードへの影響を最小限に:** **改修による既存コードの動作への影響は最低限にとどめること。** 既存コードの動作に影響する修正が必要な場合は、改修範囲の確認時点で影響点を洗い出し、ユーザーに確認を求めてください。

---

### 5. 開発プロセスのステップ（Copilotへの指示）

**コードの改修を進める際は、以下のステップに分けて開発を進めてください。各ステップは、ユーザー（開発者）の承認を得てから次に進むようにします。**

1.  **ユーザーの要件確認:**
    * ユーザーが出した要件の要点をまとめ、改修内容に齟齬が起きないか確認します。不明点があれば、ユーザーに質問を投げかけ、明確化を促します。
2.  **改修範囲、ステップ案の提案、確認:**
    * ユーザー要件に基づき、実際に修正するコードの範囲と、改修を進めるための具体的なステップ案を提案します。
    * この提案は、段階的に進められるように細分化し、各ステップでどのような変更が行われるかを明確に示します。
    * **改修が既存コードの動作に影響を与える可能性がある場合は、この時点で影響点を洗い出し、ユーザーに確認を求めてください。**
    * ユーザーに提案を確認してもらい、承認を得ます。
3.  **改修の実行と逐次確認:**
    * 提案し承認されたステップを1つ1つ進めていきます。
    * 各ステップの完了後、ユーザーに改修内容（変更点、テスト結果など）を提示し、確認を取ります。
    * ユーザーの承認を得てから、次のステップに進みます。